!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("F3",[],t):"object"==typeof exports?exports.F3=t():e.F3=t()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";const a={name:"Dummy",_actors:[],create(){},update:{_exec(){}},render:{_exec(){}}},i={_scenes:{},_current:a,_background:null,create(e,t){window.console.log(`creating scene ${e}`);const n={name:e,create:t,_actors:[],update:{_exec(e){n._actors.forEach(t=>t.update._exec(e))}},render:{_exec(e,t){n._actors.forEach(n=>n.render._exec(e,t))}}};return i._scenes[e]=n,i},get background(){return i._background},set background(e){i._background=e,window.console.log(`set background to image ${e.src}`)},load(e){if(document.body.innerHTML="",window.console.log(`loading scene ${e.name}`),!e)throw new Error("Unable to load an undefined scene reference");const t=i._scenes[e.name];if(!t)throw new Error(`Unable to load scene ${e.name}`);i._current=e,t.create()},end(){window.console.log(`ending scene ${i._current.name}`),i._current=a}};t.a=i},function(e,t,n){"use strict";var a=n(0);const i={stage:{isAspectScale:!1,canvas:null,get resize(){return i.stage._resize},set resize(e){e?window.addEventListener("resize",i.stage._resize):window.removeEventListener("resize",i.stage._resize)},_resize(){if(i.stage.isAspectScale){const e=i.stage.width<i.stage.height;let t=i.stage.width/i.stage.height;e&&(t=i.stage.height/i.stage.width);const n=1/t;e?(i.stage.canvas.height=window.innerHeight,i.stage.canvas.width=window.innerHeight*n):(i.stage.canvas.width=window.innerWidth,i.stage.canvas.height=window.innerWidth*n),i.stage.scale.x=i.stage.canvas.width/i.stage.width,i.stage.scale.y=i.stage.canvas.height/i.stage.height;const a=.5*(window.innerWidth-i.stage.canvas.width)|0,r=.5*(window.innerHeight-i.stage.canvas.height)|0;Object.assign(i.stage.canvas.style,{position:"absolute",left:`${a}px`,top:`${r}px`})}else i.stage.scale.x=window.innerWidth/i.stage.width,i.stage.scale.y=window.innerHeight/i.stage.height,i.stage.canvas.width=window.innerWidth,i.stage.canvas.height=window.innerHeight,Object.assign(i.stage.canvas.style,{position:"absolute",left:`0px`,top:`0px`})},scale:{get aspect(){return i.stage.isAspectScale},set aspect(e){i.stage.isAspectScale=e,e?window.console.log("set aspect ratio scaling on stage"):window.console.log("set fill scaling on stage")}},render(e,t){e.save(),e.scale(i.stage.scale.x,i.stage.scale.y),a.a._background?e.drawImage(a.a._background,0,0):e.clearRect(0,0,e.canvas.width,e.canvas.height),a.a._current.render._exec(e,t),e.restore()}}};t.a=i},function(e,t,n){"use strict";const a=(e,t)=>{const n={x:e,y:t,toString:()=>`Point(${n.x}, ${n.y})`};return n};t.e=a;const i=e=>Math.sqrt(e.x*e.x+e.y*e.y);t.b=i;t.c=(e=>{const t=i(e);0!==t&&(e.x/=t,e.y/=t)});const r=e=>a(-e.y,e.x),s=(e,t)=>e.x*t.x+e.y*t.y;t.a=s;t.d=((e,t)=>s(r(e),t))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"scenes",function(){return u});var a=n(4),i=n(5),r=n(0),s=n(6),o=n(7),c=n(8),l=n(10),d=n(11);n.d(t,"common",function(){return a.a}),n.d(t,"resources",function(){return i.b}),n.d(t,"asset",function(){return i.a}),n.d(t,"scene",function(){return r.a}),n.d(t,"cursor",function(){return s.a}),n.d(t,"mouse",function(){return o.a}),n.d(t,"actor",function(){return l.a}),n.d(t,"physics",function(){return d.a}),n.d(t,"ignite",function(){return c.a});const u=r.a._scenes,g={NAME:"~ F I R E S T A R T E R III ~",VERSION:"1.0.0",AUTHOR:"Richard Marks <ccpsceo@gmail.com>",COPYRIGHT:"2017, Richard Marks",LICENSE:"MIT",common:a.a,resources:i.b,asset:i.a,scene:r.a,cursor:s.a,mouse:o.a,actor:l.a,physics:d.a,ignite:c.a,scenes:u};t.default=g},function(e,t,n){"use strict";var a=n(1);const i={set title(e){document.title=e},set width(e){a.a.stage.width=e},set height(e){a.a.stage.height=e},get width(){return a.a.stage.width},get height(){return a.a.stage.height},scale:a.a.stage.scale,set resize(e){a.a.stage.resize=e}};t.a=i},function(e,t,n){"use strict";const a={_assets:{},load:e=>new Promise((t,n)=>{function i(e){if(0===e.length)return void t(a._assets);const r=e.shift(),s=new window.Image;s.onload=(()=>{a._assets[r.id]=s,i(e)}),s.onerror=(()=>{n(new Error(`Unable to load asset ${r.id} from ${r.src}`))}),s.src=r.src}i(e.slice())})};t.b=a;t.a=((e,t)=>({id:e,src:`${t}?${Date.now()}`}))},function(e,t,n){"use strict";const a={_options:{center:!1},get center(){return window.console.log("cursor.center"),a._options.center=!0,a},print(e){window.console.log(`cursor.print ${e}`);const t=document.createElement("div");return a._options.center&&Object.assign(t.style,{textAlign:"center"}),t.innerText=e,document.body.appendChild(t),a}};t.a=a},function(e,t,n){"use strict";const a={click:{_handlers:[],add(e){a.click._handlers.push(e),document.addEventListener("click",e)}}};t.a=a},function(e,t,n){"use strict";var a=n(0),i=n(1),r=n(9);t.a=(()=>{window.console.log("fire it up!");const e=document.createElement("canvas"),t=e.getContext("2d");e.width=i.a.stage.width,e.height=i.a.stage.height,document.body.appendChild(e),i.a.stage.canvas=e,i.a.stage._resize(),r.a.begin=(()=>{}),r.a.draw=(e=>{i.a.stage.render(t,e)}),r.a.update=(e=>{a.a._current.update._exec(.01*e)}),r.a.end=((n,a)=>{if(t.save(),t.textBaseline="bottom",t.font="24px sans-serif",t.fillStyle="white",t.lineWidth=4,t.fillText(`FPS: ${0|r.a.fps}`,0,e.height),t.strokeStyle="black",t.strokeText(`FPS: ${0|r.a.fps}`,1,e.height-1),t.fillText(`FPS: ${0|r.a.fps}`,0,e.height),t.restore(),a){const e=0|r.a.resetFrameDelta();window.console.warn(`Engine Panic! Discarding ${e}ms`)}}),r.a.start()})},function(e,t,n){"use strict";const a=window.requestAnimationFrame||(()=>{const e={last:0,now:0,timeout:0};return t=>{e.now=Date.now(),e.timeout=Math.max(0,1e3/60-(e.now-e.last)),e.last=e.now+e.timeout;const n=e.now+e.timeout;return setTimeout(()=>t(n),e.timeout)}}),i=window.cancelAnimationFrame||clearTimeout,r=()=>{},s={_onBegin:r,_onUpdate:r,_onDraw:r,_onEnd:r,_frameHandle:null,_simulationTimestep:1e3/60,_frameDelta:0,_lastFrameTimeMs:0,_fps:60,_lastFpsUpdate:0,_framesThisSecond:0,_numUpdateSteps:0,_minFrameDelay:0,_running:!1,_started:!1,_panic:!1,get fps(){return s._fps},set begin(e){s._onBegin=e||s._onBegin},set update(e){s._onUpdate=e||s._onUpdate},set draw(e){s._onDraw=e||s._onDraw},set end(e){s._onEnd=e||s._onEnd},resetFrameDelta(){const e=s._frameDelta;return s._frameDelta=0,e},start(){s._started||(s._started=!0,s._frameHandle=a(e=>{s._onDraw(1),s._running=!0,s._lastFrameTimeMs=e,s._lastFpsUpdate=e,s._framesThisSecond=0,s._frameHandle=a(s._animate.bind(s))}))},stop(){s._started&&(s._running=!1,s._started=!1,i(s._frameHandle))},_animate(e){if(s._frameHandle=a(s._animate.bind(s)),!(e<s._lastFrameTimeMs+s._minFrameDelay)){for(s._frameDelta+=e-s._lastFrameTimeMs,s._lastFrameTimeMs=e,s._onBegin(e,s._frameDelta),e>this._lastFpsUpdate+1e3&&(s._fps=.25*s._framesThisSecond+.75*s._fps,s._lastFpsUpdate=e,s._framesThisSecond=0),s._framesThisSecond+=1,s._numUpdateSteps=0;s._frameDelta>=s._simulationTimestep;)if(s._onUpdate(s._simulationTimestep),s._frameDelta-=s._simulationTimestep,s._numUpdateSteps+=1,s._numUpdateSteps>=240){s._panic=!0;break}s._onDraw(s._frameDelta/s._simulationTimestep),s._onEnd(s._fps,s._panic),s._panic=!1}}};t.a=s},function(e,t,n){"use strict";var a=n(0);t.a=((e,t)=>{window.console.log(`\ncreating actor ${e}\n  image: ${t.src.substring(t.src.indexOf("/"))}\n  width: ${t.width}\n  height: ${t.height}\n  `);const n={id:e,image:t,_x:0,_y:0,set x(e){n._x=e,n._prevX=e},get x(){return n._x},set y(e){n._y=e,n._prevY=e},get y(){return n._y},_prevX:0,_prevY:0,width:t.width,height:t.height,set physics(e){n._physics=e,e&&e.setup(n)},_updaters:[],_renderers:[],update:{add(e){window.console.log(`adding updater to actor ${n.id}`),n._updaters.push(e)},_exec(e){n._updaters.forEach(t=>t(e)),n._prevX=n.x,n._prevY=n.y}},render:{add(e){window.console.log(`adding renderer to actor ${n.id}`),n._renderers.push(e)},_exec(e,t){const a=n._prevX+(n._x-n._prevX)*t,i=n._prevY+(n._y-n._prevY)*t;e.save(),e.drawImage(n.image,a,i),e.restore(),n._renderers.forEach(n=>n(e,t))}}};return a.a._current._actors.push(n),n})},function(e,t,n){"use strict";var a=n(2),i=n(12);const r=e=>{if(!e)throw new Error(`Expected an actor instance, not ${e}`);e.body=Object(i.a)(e),e.body.applyFriction(9.8),e.force={add(t,n){window.console.log(`adding physics force [${t}, ${n}] to actor ${e.id}`),e.body.applyLinearForce(Object(a.e)(t,n))}},e.gravity={set y(t){e.body.applyGravity(t),e.gravity._y=t},get y(){return e.gravity._y}},e.update.add(t=>{e.body.update(t),e.body.applyGravity(e.gravity.y)})},s={kinetic:{setup(e){window.console.log(`enabling kinetic physics for actor ${e.id}`),r(e)}}};t.a=s},function(e,t,n){"use strict";var a=n(2);t.a=(e=>{const t={centerOfMass:Object(a.e)(0,0),mass:10,inertia:0,staticFrictionCoefficient:.7,kineticFrictionCoefficient:.6,coefficientOfRestitution:.4,linearVelocity:Object(a.e)(0,0),orientation:0,angularVelocity:0,totalForce:Object(a.e)(0,0),totalTorque:0,frictionForce:Object(a.e)(0,0),totalImpulse:0,updatePosition(n){t.linearVelocity.x+=t.totalForce.x/t.mass*n,t.linearVelocity.y+=t.totalForce.y/t.mass*n,e.x+=t.linearVelocity.x*n,e.y+=t.linearVelocity.y*n},updateRotation(e){t.angularVelocity+=t.totalTorque/t.inertia*e,t.orientation+=t.angularVelocity*e},updateFriction(e){const n=Object(a.e)(t.frictionForce.x/t.mass*e,t.frictionForce.y/t.mass*e);Math.abs(t.linearVelocity.x)>=Math.abs(n.x)?t.linearVelocity.x+=n.x:t.linearVelocity.x=0,Math.abs(t.linearVelocity.y)>=Math.abs(n.y)?t.linearVelocity.y+=n.y:t.linearVelocity.y=0,Math.abs(t.linearVelocity.x)<=.1&&(t.linearVelocity.x=0),Math.abs(t.linearVelocity.y)<=.1&&(t.linearVelocity.y=0),t.angularVelocity*=.995},update(e){t.updatePosition(e),t.updateRotation(e),t.updateFriction(e),t.resetForces()},resetForces(){t.totalTorque=0,t.totalImpulse=0,t.totalForce.x=0,t.totalForce.y=0,t.frictionForce.x=0,t.frictionForce.y=0},applyLinearForce(e){t.totalForce.x+=e.x,t.totalForce.y+=e.y},applyTorque(e){t.totalTorque+=e},applyForce(e,n){t.totalForce.x+=e.x,t.totalForce.y+=e.y;const i=Object(a.e)(0,0);i.x=n.x-t.centerOfMass.x,i.y=n.y-t.centerOfMass.y,t.totalTorque+=Object(a.d)(i,e)},applyGravity(e=9.8){t.applyLinearForce(Object(a.e)(0,e*t.mass))},applyFriction(e){let n=null;if(Object(a.b)(t.linearVelocity)<1){n=Object(a.e)(t.totalForce.x,t.totalForce.y),Object(a.c)(n);const i=-t.mass*e*t.staticFrictionCoefficient;n.x*=i,n.y*=i}else{n=Object(a.e)(t.linearVelocity.x,t.linearVelocity.y),Object(a.c)(n);const i=-t.mass*e*t.kineticFrictionCoefficient;n.x*=i,n.y*=i}t.frictionForce.x+=n.x,t.frictionForce.y+=n.y},handleCollision(e,n){Object(a.c)(n);const i=Object(a.e)(t.linearVelocity.x-e.linearVelocity.x,t.linearVelocity.y-e.linearVelocity.y);i.x*=-(1+t.coefficientOfRestitution),i.y*=-(1+t.coefficientOfRestitution);const r=1/t.mass+1/e.mass,s=Object(a.a)(i,n),o=Object(a.e)(n.x*r,n.y*r),c=s/Object(a.a)(n,o),l=c/t.mass,d=c/e.mass;t.linearVelocity.x+=n.x*l,t.linearVelocity.y+=n.y*l,e.linearVelocity.x+=n.x*d,e.linearVelocity.y+=n.y*d}};return t})}])});